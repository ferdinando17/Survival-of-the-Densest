(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25268,        640]
NotebookOptionsPosition[     21933,        580]
NotebookOutlinePosition[     22277,        595]
CellTagsIndexPosition[     22234,        592]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Derivation of effective SDE for mutant dynamics",
 FontColor->GrayLevel[0]]], "Title",
 CellChangeTimes->{{3.7481636089649763`*^9, 3.748163655125054*^9}, {
  3.748246906683477*^9, 3.748246927069489*^9}, {3.74824702242749*^9, 
  3.74824703037271*^9}, {3.748254031445548*^9, 3.748254032902969*^9}, {
  3.748257496293095*^9, 3.748257568973116*^9}, {3.785935102505937*^9, 
  3.785935103451602*^9}, {3.8065834640873632`*^9, 
  3.80658355236596*^9}},ExpressionUUID->"3a6516ca-2aa1-4f53-8235-\
08f1c6bc3af2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"z", "\[Element]", "Reals"}], "&&", 
    RowBox[{"Nss", "\[Element]", "Reals"}], "&&", 
    RowBox[{"c", "\[Element]", "Reals"}], "&&", 
    RowBox[{"\[Delta]", "\[Element]", "Reals"}], " ", "&&", 
    RowBox[{"c", ">", "0"}], "&&", 
    RowBox[{"\[Delta]", ">", "0"}], "&&", 
    RowBox[{"Nss", ">", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7481636089649763`*^9, 3.748163655125054*^9}, {
   3.748246906683477*^9, 3.748246927069489*^9}, {3.74824702242749*^9, 
   3.74824703037271*^9}, {3.748254031445548*^9, 3.748254032902969*^9}, {
   3.748257496293095*^9, 3.748257568973116*^9}, {3.785935102505937*^9, 
   3.785935103451602*^9}, {3.8065834640873632`*^9, 3.8065835173292637`*^9}, 
   3.806583555174472*^9, 
   3.806584606234963*^9},ExpressionUUID->"c5dafd55-de91-4fdb-a9a3-\
2c45db91784e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Definition of system of coupled SDEs",
 FontColor->GrayLevel[0]]], "Title",
 CellChangeTimes->{{3.806583610330895*^9, 3.806583624989794*^9}, 
   3.8065846126144743`*^9},ExpressionUUID->"712780d0-f96e-4f24-b1bb-\
f145f20ac238"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", "*", "m", "*", 
       RowBox[{"(", 
        RowBox[{"Nss", "-", "w", "-", 
         RowBox[{"\[Delta]", "*", "m"}]}], ")"}]}], ",", 
      RowBox[{"c", "*", "w", "*", 
       RowBox[{"(", 
        RowBox[{"Nss", "-", "w", "-", 
         RowBox[{"\[Delta]", "*", "m"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"m", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", "*", 
            RowBox[{"(", 
             RowBox[{"Nss", "-", "w", "-", 
              RowBox[{"\[Delta]", "*", "m"}]}], ")"}]}], "+", 
           RowBox[{"2", "*", "\[Mu]"}]}], ")"}]}], "]"}], ",", " ", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"w", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", "*", 
            RowBox[{"(", 
             RowBox[{"Nss", "-", "w", "-", 
              RowBox[{"\[Delta]", "*", "m"}]}], ")"}]}], "+", 
           RowBox[{"2", "*", "\[Mu]"}]}], ")"}]}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"{", 
    RowBox[{"m", ",", "w"}], "}"}]}], ";"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.748160177678959*^9, 3.748160181461623*^9}, {
   3.748160318522849*^9, 3.748160369491707*^9}, {3.748160408966906*^9, 
   3.748160421783442*^9}, {3.748160483362545*^9, 3.748160513152195*^9}, {
   3.748160567982787*^9, 3.748160569098722*^9}, {3.74816060262792*^9, 
   3.748160606582192*^9}, {3.7481619353086*^9, 3.748161938967684*^9}, {
   3.7482460193803368`*^9, 3.74824612639123*^9}, {3.748254011895569*^9, 
   3.748254013325245*^9}, {3.7482574803353243`*^9, 3.7482574854927893`*^9}, {
   3.7482575768785954`*^9, 3.748257626118594*^9}, {3.748257675833321*^9, 
   3.748257694076755*^9}, {3.7486933242490587`*^9, 3.748693327179696*^9}, {
   3.7486933691270113`*^9, 3.748693370292059*^9}, {3.785935095998067*^9, 
   3.785935099633658*^9}, {3.785935215935195*^9, 3.7859352201525707`*^9}, {
   3.8065836076799383`*^9, 3.8065836326954527`*^9}, {3.806583973783352*^9, 
   3.806583983371275*^9}, {3.8065840348039494`*^9, 3.8065840705609913`*^9}, 
   3.806584143495809*^9, 3.8065843520986557`*^9, {3.806584428975724*^9, 
   3.8065844291325693`*^9}, {3.8065844667619963`*^9, 3.806584470812037*^9}, 
   3.807349881749338*^9},ExpressionUUID->"e68ab048-bb1f-4e53-9f19-\
4d22b0dd353c"],

Cell["Computing Hessians", "Item",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQzbHLNIzn7WvHeUfXgWm93RfSQbTAHv08EP30g1wx
iP4quLMERP+YmV0Dok/cU2kA0f+K/reB6N0ayu0g+o14SDeIDlx4CUzzPnhp
yAukXb7HGYHoHdo5DmYg81rO+ILohhU16lZAOiNjFZj+tYvrpjWQfndkPZgu
kZV5CqLbTju/BtETV1V9BNHHSw59BtFeP9pXCrx77Sh04CmYrhJQWQ+ieyI8
wbTWh/9ykqZvHN+6lciDaLm3f3VB9J2HLXogmu/Q17TqmDeOao5iWSDaQnDn
FBBd8/D1VBD9ZWfkHBC9a++CxSAaAAzRo2A=
  
  "],ExpressionUUID->"4f9ca010-8b57-432c-a07c-c1e6174639b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H1", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "w"}], "}"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"H2", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "w"}], "}"}], ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.748160177678959*^9, 3.748160181461623*^9}, {
   3.748160318522849*^9, 3.748160369491707*^9}, {3.748160408966906*^9, 
   3.748160421783442*^9}, {3.748160483362545*^9, 3.748160513152195*^9}, {
   3.748160567982787*^9, 3.748160569098722*^9}, {3.74816060262792*^9, 
   3.748160606582192*^9}, {3.7481619353086*^9, 3.748161938967684*^9}, {
   3.7482460193803368`*^9, 3.74824612639123*^9}, {3.748254011895569*^9, 
   3.748254013325245*^9}, {3.7482574803353243`*^9, 3.7482574854927893`*^9}, {
   3.7482575768785954`*^9, 3.748257626118594*^9}, {3.748257675833321*^9, 
   3.748257694076755*^9}, {3.7486933242490587`*^9, 3.748693327179696*^9}, {
   3.7486933691270113`*^9, 3.748693370292059*^9}, {3.785935095998067*^9, 
   3.785935099633658*^9}, {3.785935215935195*^9, 3.7859352201525707`*^9}, {
   3.8065836076799383`*^9, 3.8065836326954527`*^9}, {3.806583973783352*^9, 
   3.806583983371275*^9}, {3.8065840348039494`*^9, 3.806584080793993*^9}, 
   3.8065841409850397`*^9, 3.806584337830435*^9, {3.80658446857185*^9, 
   3.8065844717523947`*^9}},ExpressionUUID->"40712110-f912-4df9-9454-\
ea5e1fec2930"],

Cell["\<\
Defining variable constrained to central manifold (CM), with z=m (mutant copy \
number).\
\>", "Item",
 CellChangeTimes->{
  3.748246079194784*^9, 3.748246135861011*^9, {3.748257841284945*^9, 
   3.748257855548884*^9}, {3.7482579578812313`*^9, 3.7482579580348*^9}, {
   3.8065841751447077`*^9, 
   3.806584265536091*^9}},ExpressionUUID->"853fa293-30db-4b15-a117-\
6c94ea6220e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]", "=", 
   RowBox[{"{", 
    RowBox[{"z", ",", 
     RowBox[{"Nss", "-", 
      RowBox[{"\[Delta]", "*", "z"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.748246079194784*^9, 3.748246135861011*^9, {3.748257841284945*^9, 
   3.748257855548884*^9}, {3.7482579578812313`*^9, 3.7482579580348*^9}, {
   3.8065841751447077`*^9, 3.806584179313962*^9}, 3.806584384206359*^9, {
   3.806584415705977*^9, 
   3.806584445828472*^9}},ExpressionUUID->"67d2ffd3-631d-434d-99d4-\
7068de80eca5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]", "'"}], "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"\[Gamma]", ",", "z"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.748161943965705*^9, 3.748162046722023*^9}, {
  3.7481816968357363`*^9, 3.748181714123714*^9}, {3.74825787581102*^9, 
  3.748257894366827*^9}, {3.7487768109088287`*^9, 3.748776823767798*^9}, {
  3.806583580285833*^9, 3.806583599693811*^9}, {3.806584473889265*^9, 
  3.806584475303063*^9}},ExpressionUUID->"047c99b2-a75c-4d5b-b24f-\
8f5949febc94"],

Cell[CellGroupData[{

Cell["\<\
Definition of Jacobian. Evaluation on central manifold  (CM) and \
eigendecomposition.\
\>", "Chapter",
 CellChangeTimes->{{3.748257888424209*^9, 3.748257889254129*^9}, {
  3.806582257199265*^9, 3.806582261072075*^9}, {3.806583668202319*^9, 
  3.8065836933654118`*^9}},ExpressionUUID->"2ef7ae2f-684b-4070-87fa-\
1e993e4eef8c"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"J", "=", 
    RowBox[{"D", "[", 
     RowBox[{"f", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], ";"}],
  FontSize->12]], "Input",
 CellChangeTimes->{{3.748160560539289*^9, 3.7481605713995447`*^9}, {
  3.806582263273687*^9, 3.806582276727787*^9}, {3.806582319984006*^9, 
  3.8065823498814983`*^9}, {3.806582380419849*^9, 3.806582441543565*^9}, {
  3.8065836972080603`*^9, 
  3.8065837026570873`*^9}},ExpressionUUID->"ae008c0b-58f6-46d6-afc4-\
fcbc9f8e1fa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"Nss", "-", 
    RowBox[{"\[Delta]", "*", "m"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7481607633057528`*^9, 3.748160764697586*^9}, {
  3.748160863502284*^9, 3.748160874206339*^9}, {3.748257967695587*^9, 
  3.7482579797225924`*^9}, {3.748776853271599*^9, 3.748776853805255*^9}, {
  3.806582485657167*^9, 3.8065825142883873`*^9}, {3.8065828768907557`*^9, 
  3.806582881386383*^9}, {3.8065837073041067`*^9, 
  3.806583709054655*^9}},ExpressionUUID->"7a65d435-b415-464b-8fd5-\
314255afa3c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"Transpose", "[", "J", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.748161508629299*^9, 3.7481615717322187`*^9}, 
   3.748182460258559*^9, 3.748242607603305*^9, 
   3.806582574793301*^9},ExpressionUUID->"6576af26-3b94-4110-873a-\
e3e8a9f6e050"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizationFactor", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"v", ",", 
      RowBox[{"\[Gamma]", "'"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7481623916239853`*^9, 3.74816239424551*^9}, {
  3.748181323874446*^9, 3.7481813290157747`*^9}, {3.748181736172504*^9, 
  3.748181737653447*^9}, {3.8065837773739557`*^9, 
  3.806583784878272*^9}},ExpressionUUID->"acd94abe-0f20-4137-9273-\
df16454cce71"],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"v", "/", "NormalizationFactor"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.748161661824903*^9, 3.748161705434928*^9}, {
   3.748161760396245*^9, 3.748161805598781*^9}, {3.7481620511784077`*^9, 
   3.748162096160776*^9}, {3.748162131970252*^9, 3.7481623477255898`*^9}, {
   3.748162403006948*^9, 3.748162407170237*^9}, {3.7481811465391006`*^9, 
   3.748181157935197*^9}, {3.748181196299926*^9, 3.748181197698584*^9}, {
   3.748181307580999*^9, 3.748181313527914*^9}, {3.748181740532115*^9, 
   3.748181745073174*^9}, {3.8065837892719593`*^9, 3.8065837925256042`*^9}, 
   3.806584568212265*^9},ExpressionUUID->"2c625ff7-590e-46cc-9bae-\
2f9fed433f45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Eigenvectors", "[", "J", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7482437527043543`*^9, 3.7482437596298847`*^9}, {
   3.748244233843604*^9, 3.7482442411500893`*^9}, {3.748258006441293*^9, 
   3.748258007573086*^9}, 
   3.806584569672662*^9},ExpressionUUID->"46970f1e-fef0-45bf-8f14-\
4b00f2f4e682"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Computation of pseudo-inverse of Jacobian, of \
projection matrix P and of matrix Q_1  ",
 FontColor->GrayLevel[0]]], "Chapter",
 CellChangeTimes->{{3.806583808230137*^9, 3.80658382950214*^9}, {
  3.806583859750639*^9, 3.806583867429957*^9}, {3.806583906981382*^9, 
  3.806583910766911*^9}, {3.806584515633092*^9, 
  3.8065845775122023`*^9}},ExpressionUUID->"b1446c4e-66fa-4227-a3df-\
d71868a95512"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jpi", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"W", ".", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"1", "/", 
         RowBox[{
          RowBox[{"Eigenvalues", "[", "J", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "]"}], ".", 
     RowBox[{"Inverse", "[", "W", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.748243988965495*^9, 3.748243992959466*^9}, {
   3.748244308102364*^9, 3.748244349590803*^9}, {3.7482443876890907`*^9, 
   3.7482443910129538`*^9}, {3.7482444247888937`*^9, 
   3.7482444325430193`*^9}, {3.748245004924901*^9, 3.7482450121997147`*^9}, 
   3.748245653780735*^9, 3.748252592148349*^9, {3.748258098984536*^9, 
   3.748258099140052*^9}, {3.806583014090803*^9, 3.806583029578343*^9}, 
   3.8065838334643393`*^9, {3.806583918944599*^9, 3.806583920342412*^9}, 
   3.806583987863844*^9},ExpressionUUID->"0f913382-36bd-4fcf-b222-\
ee820bee7346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pf", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "2", "]"}], "-", 
     RowBox[{"Jpi", ".", "J"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7482439904081593`*^9, 3.748243991211955*^9}, {
   3.748244356472625*^9, 3.748244399080737*^9}, {3.7482445430945168`*^9, 
   3.748244549134392*^9}, {3.7482446315017653`*^9, 3.7482446375357637`*^9}, {
   3.748244963882248*^9, 3.748244971902939*^9}, {3.7482450210718193`*^9, 
   3.748245023992844*^9}, {3.748252768417243*^9, 3.748252769531165*^9}, 
   3.8065839271937647`*^9},ExpressionUUID->"a8518810-7bb5-48e9-ba5d-\
efec331257a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Q1", "=", 
    RowBox[{"-", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Jpi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "Pf", "]"}], ".", "H1", ".", "Pf"}]}], "+", 
       RowBox[{
        RowBox[{"Pf", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", "Jpi", "]"}], ".", "H1", ".", "Pf"}], 
          "+", 
          RowBox[{
           RowBox[{"Transpose", "[", "Pf", "]"}], ".", "H1", ".", "Jpi"}]}], 
         ")"}]}], "+", 
       RowBox[{
        RowBox[{"Jpi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "Pf", "]"}], ".", "H2", ".", "Pf"}]}], "+", 
       RowBox[{
        RowBox[{"Pf", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", "Jpi", "]"}], ".", "H2", ".", "Pf"}], 
          "+", 
          RowBox[{
           RowBox[{"Transpose", "[", "Pf", "]"}], ".", "H2", ".", "Jpi"}]}], 
         ")"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7482526868789682`*^9, 3.7482529038058357`*^9}, {
   3.748252954003852*^9, 3.748252980124125*^9}, {3.748253149176077*^9, 
   3.748253150837473*^9}, {3.748254305431555*^9, 3.748254307236105*^9}, 
   3.7482546301423597`*^9, {3.806583999256769*^9, 3.806584027128489*^9}, {
   3.806586483808506*^9, 
   3.8065865113355007`*^9}},ExpressionUUID->"5c5742ae-296a-4122-9913-\
d6ee33bb4e35"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computation of drift term", "Chapter",
 CellChangeTimes->{{3.748254605558055*^9, 3.748254652320166*^9}, {
  3.748256280476738*^9, 3.748256305009068*^9}, {3.7482610552788258`*^9, 
  3.748261056648687*^9}, {3.748687230449622*^9, 3.7486872311542*^9}, {
  3.7521599995985947`*^9, 3.752159999800126*^9}, {3.80658319826884*^9, 
  3.80658320678016*^9}, {3.806584634906279*^9, 3.8065846572968483`*^9}, {
  3.807611809781754*^9, 
  3.807611810404982*^9}},ExpressionUUID->"8ba96cf4-16b1-4762-ac2c-\
7136892328e9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Drift", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{"G", ".", 
      RowBox[{"Transpose", "[", "G", "]"}], ".", "Q1"}], "]"}], "/", "2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.748254605558055*^9, 3.748254652320166*^9}, {
  3.748256280476738*^9, 3.748256305009068*^9}, {3.7482610552788258`*^9, 
  3.748261056648687*^9}, {3.748687230449622*^9, 3.7486872311542*^9}, {
  3.7521599995985947`*^9, 3.752159999800126*^9}, {3.80658319826884*^9, 
  3.80658320678016*^9}, {3.806584634906279*^9, 
  3.806584646772564*^9}},ExpressionUUID->"ceb3d4be-59c2-40e7-bdb2-\
8d3518ad5361"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Delta]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "Nss"}], "+", 
     RowBox[{"m", " ", "\[Delta]"}]}], ")"}], " ", "\[Mu]"}], 
  SuperscriptBox["Nss", "2"]]], "Output",
 CellChangeTimes->{
  3.8065866743810463`*^9, {3.807349884281502*^9, 3.807349893365265*^9}, 
   3.807351127705358*^9, 
   3.807351158684572*^9},ExpressionUUID->"b0b380db-7d2a-4640-bbd9-\
4b54c2aae989"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Computation of diffusion term (the term that multiplies the Wiener process)\
\>", "Chapter",
 CellChangeTimes->{{3.748254848570347*^9, 3.748254917242998*^9}, {
   3.7482558451504097`*^9, 3.7482558496063337`*^9}, 3.7482610604291363`*^9, {
   3.748687233458036*^9, 3.748687235414352*^9}, {3.806583278164559*^9, 
   3.806583282944852*^9}, {3.8065833229226522`*^9, 3.80658335374822*^9}, {
   3.806584662986301*^9, 3.8065846817516613`*^9}, {3.8076118118623943`*^9, 
   3.8076118317336607`*^9}},ExpressionUUID->"be3296a1-be68-4601-b253-\
1ef9be5319c7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Eta", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"\[Eta]1", ",", "\[Eta]2"}], "}"}], "}"}]}], " ", ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Vector", " ", "of", " ", "Wiener", " ", "noises"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NoiseTerm", "=", 
  RowBox[{"P", ".", "G", ".", 
   RowBox[{"Transpose", "[", "Eta", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.748254848570347*^9, 3.748254917242998*^9}, {
   3.7482558451504097`*^9, 3.7482558496063337`*^9}, 3.7482610604291363`*^9, {
   3.748687233458036*^9, 3.748687235414352*^9}, {3.806583278164559*^9, 
   3.806583282944852*^9}, {3.8065833229226522`*^9, 3.80658335374822*^9}, {
   3.806584662986301*^9, 3.806584701923431*^9}, {3.806584899762361*^9, 
   3.8065849028298597`*^9}, 3.80658493988948*^9, {3.8065849776657877`*^9, 
   3.80658505522009*^9}, {3.8065863609843407`*^9, 3.8065863780885887`*^9}, {
   3.806586533143639*^9, 
   3.806586544303547*^9}},ExpressionUUID->"c38c2bac-774f-467e-9678-\
ec129f22d78f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SqrtBox["2"], " ", 
     RowBox[{"(", 
      RowBox[{"Nss", "-", 
       RowBox[{"m", " ", "\[Delta]"}]}], ")"}], " ", "\[Eta]1", " ", 
     SqrtBox[
      RowBox[{"m", " ", "\[Mu]"}]]}], "Nss"], "-", 
   FractionBox[
    RowBox[{
     SqrtBox["2"], " ", "m", " ", "\[Eta]2", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Nss", "-", 
         RowBox[{"m", " ", "\[Delta]"}]}], ")"}], " ", "\[Mu]"}]]}], "Nss"]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.806586674403016*^9, {3.8073498842885647`*^9, 3.807349893390009*^9}, 
   3.807351127749502*^9, 
   3.807351158711812*^9},ExpressionUUID->"f5bed77f-3d05-40bf-9ee6-\
32e7dd32a2b5"]
}, Open  ]],

Cell["The above diffusion terms can be combined into a single one:", "Text",
 CellChangeTimes->{{3.806585111113854*^9, 3.806585147896306*^9}, {
   3.8065863861599216`*^9, 3.806586432414392*^9}, {3.806586554302208*^9, 
   3.806586607350857*^9}, {3.807611805806604*^9, 3.80761180834149*^9}, 
   3.807946981616671*^9},ExpressionUUID->"b42ad6eb-431b-4763-9152-\
6786ddd060eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Var", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"P", ".", "G"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"P", ".", "G"}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.806586352931156*^9, 3.806586356510689*^9}, {
  3.80658649407701*^9, 
  3.806586494951366*^9}},ExpressionUUID->"b59d3e7b-b6e6-463d-9b60-\
1db801ccb6df"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "Nss"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Delta]"}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "Nss"}], "+", 
     RowBox[{"m", " ", "\[Delta]"}]}], ")"}], " ", "\[Mu]"}], 
  SuperscriptBox["Nss", "2"]]], "Output",
 CellChangeTimes->{
  3.8065866744234457`*^9, {3.807349884333887*^9, 3.8073498934135017`*^9}, 
   3.8073511277949743`*^9, 
   3.807351158737575*^9},ExpressionUUID->"07e156e8-a06d-4c2e-94d4-\
246073c90851"]
}, Open  ]],

Cell["\<\
This is the variance of the Wiener process that drives the SDE.\
\>", "Text",
 CellChangeTimes->{{3.807946986734921*^9, 
  3.807946999742633*^9}},ExpressionUUID->"262d9170-e1e9-42c2-abcd-\
3636a76ef1de"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1680, 1020},
WindowMargins->{{Automatic, 1366}, {Automatic, -16}},
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 525, 8, 98, "Title",ExpressionUUID->"3a6516ca-2aa1-4f53-8235-08f1c6bc3af2"],
Cell[1108, 32, 958, 19, 55, "Input",ExpressionUUID->"c5dafd55-de91-4fdb-a9a3-2c45db91784e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2103, 56, 250, 4, 98, "Title",ExpressionUUID->"712780d0-f96e-4f24-b1bb-f145f20ac238"],
Cell[2356, 62, 2654, 64, 124, "Input",ExpressionUUID->"e68ab048-bb1f-4e53-9f19-4d22b0dd353c"],
Cell[5013, 128, 477, 9, 32, "Item",ExpressionUUID->"4f9ca010-8b57-432c-a07c-c1e6174639b4"],
Cell[5493, 139, 1711, 38, 78, "Input",ExpressionUUID->"40712110-f912-4df9-9454-ea5e1fec2930"],
Cell[7207, 179, 388, 9, 32, "Item",ExpressionUUID->"853fa293-30db-4b15-a117-6c94ea6220e4"],
Cell[7598, 190, 533, 13, 31, "Input",ExpressionUUID->"67d2ffd3-631d-434d-99d4-7068de80eca5"],
Cell[8134, 205, 627, 14, 78, "Input",ExpressionUUID->"047c99b2-a75c-4d5b-b24f-8f5949febc94"],
Cell[CellGroupData[{
Cell[8786, 223, 336, 7, 69, "Chapter",ExpressionUUID->"2ef7ae2f-684b-4070-87fa-1e993e4eef8c"],
Cell[9125, 232, 507, 13, 30, "Input",ExpressionUUID->"ae008c0b-58f6-46d6-afc4-fcbc9f8e1fa9"],
Cell[9635, 247, 549, 11, 31, "Input",ExpressionUUID->"7a65d435-b415-464b-8fd5-314255afa3c0"],
Cell[10187, 260, 400, 10, 31, "Input",ExpressionUUID->"6576af26-3b94-4110-873a-e3e8a9f6e050"],
Cell[10590, 272, 483, 11, 31, "Input",ExpressionUUID->"acd94abe-0f20-4137-9273-df16454cce71"],
Cell[11076, 285, 706, 12, 31, "Input",ExpressionUUID->"2c625ff7-590e-46cc-9bae-2f9fed433f45"],
Cell[11785, 299, 400, 9, 31, "Input",ExpressionUUID->"46970f1e-fef0-45bf-8f14-4b00f2f4e682"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12222, 313, 423, 7, 69, "Chapter",ExpressionUUID->"b1446c4e-66fa-4227-a3df-d71868a95512"],
Cell[12648, 322, 994, 21, 31, "Input",ExpressionUUID->"0f913382-36bd-4fcf-b222-ee820bee7346"],
Cell[13645, 345, 658, 13, 31, "Input",ExpressionUUID->"a8518810-7bb5-48e9-ba5d-efec331257a1"],
Cell[14306, 360, 1805, 49, 101, "Input",ExpressionUUID->"5c5742ae-296a-4122-9913-d6ee33bb4e35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16148, 414, 509, 8, 69, "Chapter",ExpressionUUID->"8ba96cf4-16b1-4762-ac2c-7136892328e9"],
Cell[CellGroupData[{
Cell[16682, 426, 642, 14, 31, "Input",ExpressionUUID->"ceb3d4be-59c2-40e7-bdb2-8d3518ad5361"],
Cell[17327, 442, 515, 15, 54, "Output",ExpressionUUID->"b0b380db-7d2a-4640-bbd9-4b54c2aae989"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17891, 463, 556, 9, 69, "Chapter",ExpressionUUID->"be3296a1-be68-4601-b253-1ef9be5319c7"],
Cell[CellGroupData[{
Cell[18472, 476, 1035, 22, 55, "Input",ExpressionUUID->"c38c2bac-774f-467e-9678-ec129f22d78f"],
Cell[19510, 500, 736, 24, 58, "Output",ExpressionUUID->"f5bed77f-3d05-40bf-9ee6-32e7dd32a2b5"]
}, Open  ]],
Cell[20261, 527, 372, 5, 35, "Text",ExpressionUUID->"b42ad6eb-431b-4763-9152-6786ddd060eb"],
Cell[CellGroupData[{
Cell[20658, 536, 390, 11, 31, "Input",ExpressionUUID->"b59d3e7b-b6e6-463d-9b60-1db801ccb6df"],
Cell[21051, 549, 626, 19, 54, "Output",ExpressionUUID->"07e156e8-a06d-4c2e-94d4-246073c90851"]
}, Open  ]],
Cell[21692, 571, 213, 5, 35, "Text",ExpressionUUID->"262d9170-e1e9-42c2-abcd-3636a76ef1de"]
}, Open  ]]
}, Open  ]]
}
]
*)

